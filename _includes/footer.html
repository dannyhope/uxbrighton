  <style>
    .flex-over-m .block-link,
    .flex-over-m .block-link:hover {
      display: flex;
      flex-direction: column;
    }

    .upcoming-teaser__wrapper {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;

    }
    .upcoming-teaser {
      width: 100%;
      max-width: 635px;
      text-align: left;
    }
    .upcoming-teaser__text {
      flex: 1 0 auto;
      min-height: 13em;
    }
    [type="checkbox"] {
      margin: 5px 5px 0 0;
    }
  </style>


  {% assign has_upcoming = false %}
  {% assign postnum = 1 %}
  {% for post in site.posts %}
    {% if post.upcoming == true and post.published == true %}
      {% assign has_upcoming = true %}
    {% endif %}
  {% endfor %}

  {% if has_upcoming  %}
    {% if page.events.event-promo-footer == null or page.events.event-promo-footer != "hide" %}
      <aside>
        <section id="promotions">
          <hr>
          <div class="row text-center">
            <h3 class="fs-h2 mt0 gutter-bottom">
              {% if page.url contains "/2022/" or page.layout == "event-page" %}Other {% endif %}UX Brighton events
            </h3>

            <div class="flex-over-m upcoming-teaser__wrapper">
              {% assign varnum = 1 %}
              {% if has_upcoming %}
                {% for post in site.posts reversed limit:4 %}
                  {% if post.upcoming == true && if post.published == true %}
                      {% if post.slug == page.slug %}
                      {% else %}
                        <div class="upcoming-teaser gutters flex-over-m gutter-bottom">
                          <a href="{{ site.url }}{{post.url}}" class="block-link fill tile pa3 rounded drop relative" style="background: url('{{post.upcoming-teaser.bg-image}}') center center no-repeat #1a272c; background-size: cover;">
                            <div class="overlay-absolute" style="background: rgba(0, 0, 0, 0.5);"></div>
                            <div class="upcoming-teaser__text">
                              <h1 class="leading-solid mb2 color-white fs-xl relative">
                                <span class="fs-m mb1 block color-orange font-museo track-normal" style="font-weight: 500;">{{post.date | date: "%-d %B %Y"}}{% if post.start %}<span class="event-time inline-block">, {{ post.start }}</span>{% endif %}</span>
                                {% if post.upcoming-teaser.title %}
                                  {{ post.upcoming-teaser.title }}
                                {% else %}
                                  {{ post.title }}
                                {% endif %}
                              </h1>
                              <div class="mt0 regular track-normal mb3 relative">
                                <div class="color-white">
                                  {% if post.upcoming-teaser.text %}
                                    {{ post.upcoming-teaser.text }}
                                  {% else %}
                                    {{ post.description }}
                                  {% endif %}
                                </div>
                              </div>
                            </div>
                            <div class="upcoming-teaser__button-wrapper">
                              <div href="{{ site.url }}{{post.url}}" class="button button--green bold standfirst mb0">
                                {% if post.upcoming-teaser.label %}
                                    {{ post.upcoming-teaser.label }}
                                  {% else %}
                                    Tickets and info
                                  {% endif %}
                              </div>
                            </div>
                          </a>
                        </div>
                      {% assign varnum = varnum | plus: 1 %}
                    {% endif %}
                  {% endif %}
                {% endfor %}
              {% endif %}
            </div><!-- gutters__container -->
          </div><!-- .row -->
        </section>
      </aside>
    {% endif %}
  {% endif %}






  <div class="overlay-active-underlay full-screen-overlay hidden" onclick="$('body').attr('data-overlay-active','false'); $( '#js-newsletter-thanks' ).css('color', '');"></div>
  <footer class="bg-grey-90 color-grey-10">
    <div class="container pt1">
      <div class="row" style="display: none;>
        <!-- u1of2-over-s -->
        <div class="u1of2-over-m left-over-m gutter-left pb3">
          <div class="inline-block right-over-m center-under-m">
            <nav class="social-icons icons-currentColor pt1 clearfix">
              <a class="social-icons__link social-icons__link--linkedin" href="https://www.linkedin.com/company/ux-brighton">
                <span class="screen-reader-text">linkedin</span>
                <svg viewBox="0 0 409 409">
                  <use xlink:href="/2018/images/icons/social-sprite.svg#linkedin"></use>
                </svg>
              </a>
              <a class="social-icons__link social-icons__link--youtube" href="https://www.youtube.com/channel/UC9hOYRFJn2NgV406gr9jajw">
                <span class="screen-reader-text">youtube</span>
                <svg viewBox="0 0 579 409">
                  <use xlink:href="/2018/images/icons/social-sprite.svg#youtube"></use>
                </svg>
              </a>
              <a class="social-icons__link social-icons__link--twitter" href="https://twitter.com/uxbri">
                <span class="screen-reader-text">twitter</span>
                <svg viewBox="0 0 493 409">
                  <use xlink:href="/2018/images/icons/social-sprite.svg#twitter"></use>
                </svg>
              </a>
              <a class="social-icons__link social-icons__link--facebook" href="https://www.facebook.com/uxbrighton/" style="width:30px;">
                <span class="screen-reader-text">facebook</span>
                <svg viewBox="0 0 409 409">
                  <use xlink:href="/2018/images/icons/social-sprite.svg#icon-facebook2"></use>
                </svg>
              </a>
            </nav>
          </div>

        </div><!-- u1of2-over-s -->
      </div><!-- row -->

      <div class="row text-center">
       <a class="bold inline-block" href="/about">About UX Brighton</a>
       <span class="hide-footer-middot">&emsp;&emsp;&emsp;</span>
       <br class="break-footer-links" />
       <a class="bold inline-block" href="/mentorship">Mentorship</a>
       <span class="hide-footer-middot">&emsp;&emsp;&emsp;</span>
       <br class="break-footer-links" />
       <a class="bold inline-block" href="http://dannyhope.co.uk/">A Danny Hope Production</a>
      </div>


      <form id="slack-signup" class="hidden form-inline bg-white z4 triangle-top-right mr2" action="https://slofile.com/slack/uxbri/invite" accept-charset="UTF-8" method="post" target="slackFrame">
        <div class="pa3">
          <h2 class="mb1" style="font-size: 21px; letter-spacing: -0.02em;">Your Email Address</h2>
          <input name="utf8" type="hidden" value="âœ“">
          <input type="hidden" name="authenticity_token" value="PWn79CzsqJB996ucMtB+K9FMPe+7eYsWJx9s8RI82qpKZdztqM46BM3PH7EiTiWVYgzuSOodP5eud36luQeT9Q==">
          <div class="input-group mt1 mb1">
            <label class="screen-reader-text" for="email">Email</label>
            <input type="email" name="email" id="email" value="" placeholder="Email Address" class="input-group__field border--none rounded-left">
            <input type="submit" name="commit" value="Join" class="button input-group__button button--green rounded-right">
          </div>
        </div>
      </form>

    </div><!-- container -->
  </footer>






  <script>
    // if browser has serviceWorkers remove service worker caches and registrations
    if ('serviceWorker' in navigator) {
      caches.keys().then(function(cacheNames) {
        cacheNames.forEach(function(cacheName) {
          caches.delete(cacheName);
        });
      });
      navigator.serviceWorker.getRegistrations().then(function(registrations) {
       for(let registration of registrations) {
        registration.unregister()
      } });
    }
  </script>


  <script src="https://code.jquery.com/jquery-3.3.1.js" integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60=" crossorigin="anonymous"></script>
  <script src="https://code.jquery.com/jquery-migrate-3.0.0.min.js" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-touch-events/2.0.0/jquery.mobile-events.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
  <script src="/2022/javascripts/scripts-min.js?v=2022-05-19_12:04"></script>
  <script>try { $.each(q,function(i,f){$(f)});} catch(e) {}</script>

  {% comment %} Email subscription {% endcomment %}
  <script src="/scripts/components/emailSubscription.js"></script>


  <script>
    $(function() {
      var options = { valueNames: [ 'post-excerpt'] };
      var userList = new List('js-archive-nav', options);
      function displayNewsletter(){
        var _val = "newsletter",
            _currentVal = $('body').attr('data-overlay-active');
        if (_val == _currentVal) {
          $("body").attr('data-overlay-active','false');
        } else {
          $("body").attr('data-overlay-active',_val);
          if (_val == 'menu'){ $( '.archive-nav__search' ).focus(); }
          if (_val == 'slack'){ $( '#email' ).focus(); }
          if (_val == 'newsletter'){ $( '#fieldEmail' ).focus(); }
        }
      };

      if (/[?&]open=newsletter/.test(location.search)) {
        displayNewsletter();
      }

      // getCookie(name)
      // setCookie(name, value, days)
      // deleteCookie(name)

    });


      $('[type="email"]').on('focus', function(){
        $(this).removeClass('is-invalid');
      });
      function newsletterAnalytics (event) {
        event.preventDefault();
        var newsletterOptions = $(this).closest('[data-news-options]').attr('class');
        newsletterOptions = newsletterOptions.trim().replace(/ /g, ' - ');
        if (newsletterOptions == "") {
          $(this).closest('form').find('.js-email-no-choice').slideDown();
        } else {
          var fieldToTest  = $(this).closest('form').find('[type="email"]')[0];
          var isValidEmail = fieldToTest.checkValidity();
          if ( isValidEmail ) {
            window.dataLayer = window.dataLayer || [];
            dataLayer.push({
              'event' : 'formSubmission',
              'formName' : 'contact us',
              'formFieldsSelected' : newsletterOptions
            });
            console.log('newsletterOptions',newsletterOptions);
            $(this).closest('form').submit();
          } else {
            $(this).closest('form').find('.js-email-no-email').slideDown();
          }
        }
      }

  </script>






  {% if page.url contains "/jobs/" %}
    <link rel="stylesheet" type="text/css" href="/js/tooltipster-master/dist/css/tooltipster.bundle.min.css" />
    <link rel="stylesheet" type="text/css" href="/js/tooltipster-master/dist/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-shadow.min.css" />
    <script type="text/javascript" src="/js/tooltipster-master/dist/js/tooltipster.bundle.min.js"></script>
    <script>
      $(function() {
        $('.tooltip').tooltipster({
          animation: 'fade',
          delay: 1,
          theme: 'tooltipster-shadow'
        });
      });

      var jobs_stored  = [{% for job in site.data.jobs %}{% if job.publish == 'TRUE' %}'{{ job.job-id }}',{% endif %}{% endfor %}
      ];
      var json_str = JSON.stringify(jobs_stored);
      setCookie('jobs_stored', json_str);

    </script>
  {% else %}
    <script>
      // var jobs_stored  = ['peter','ko38r4h','invu9e','nviuo3','hh9e0nc','8uggvtd'];
      // var json_str = JSON.stringify(jobs_stored);
      // setCookie('jobs_stored', json_str);
    </script>
  {% endif %}


  <script>
    var jobs_current     = [
      {% for job in site.data.jobs %}{% if job.publish == 'TRUE' %}'{{ job.job-id }}',{% endif %}{% endfor %}
    ];
    var jobs_stored = getCookie('jobs_stored');
    jobs_stored = JSON.parse(jobs_stored);
    var jobs_diff  = $(jobs_current).not(jobs_stored).get().length;
    var unviewed_number = "unviewed--single";
    if (jobs_diff > 0) {
      if (jobs_diff > 9) { jobs_diff = "9+";unviewed_number = "unviewed--double"; }
      $('.masthead__link--jobs').addClass(unviewed_number).append('<span class="unviewed">'+jobs_diff+'</span>');
    };
  </script>

  <script>
    var upcoming_current  = [];
    {% assign has_upcoming = false %}
    {% for post in site.posts %}
      {% if post.upcoming == true && if post.published == true %}
        {% assign has_upcoming = true %}
      {% endif %}
    {% endfor %}
    {% if has_upcoming %}
    upcoming_current  = [ {% for post in site.posts %}{% if post.upcoming == true && if post.published == true %}'{% if post.conference-url %}{{ post.conference-url }}{% else %}{{ post.url }}{% endif %}',{% endif %}{% endfor %} ];
    {% endif %}
    //console.log('upcoming_current',upcoming_current);

    var upcoming_stored = getCookie('upcoming_stored');
    upcoming_stored = JSON.parse(upcoming_stored);
    if (upcoming_stored == null) {
      upcoming_stored = [];
    }

    //console.log('upcoming_stored',upcoming_stored);

    //If the current pathname is in the upcoming current, but not the upcoming stored, add the pathname to upcoming stored and re set cookie with update

    var this_path = window.location.pathname
    //console.log('this_path',this_path);
    if ((upcoming_current.indexOf(this_path) > -1)){
      if ((upcoming_stored.indexOf(this_path) == -1)){
        upcoming_stored.push(this_path);
        //console.log('upcoming_stored2',upcoming_stored);
      }
    }
    var json_str = JSON.stringify(upcoming_stored);
    setCookie('upcoming_stored', json_str);
    var upcoming_diff    = $(upcoming_current).not(upcoming_stored).get().length;
    var unviewed_number = "unviewed--single";
    if (upcoming_diff > 0) {
      if (upcoming_diff > 9) { jobs_diff = "9+";unviewed_number = "unviewed--double"; }
      $('.masthead__link--events').addClass(unviewed_number).append('<span class="unviewed">'+upcoming_diff+'</span>');
    };
  </script>
